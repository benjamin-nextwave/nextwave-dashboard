---
phase: 02-company-management-default-tasks
plan: 01
type: tdd
wave: 1
depends_on: []
files_modified:
  - src/lib/default-tasks.ts
  - src/lib/__tests__/default-tasks.test.ts
autonomous: true

must_haves:
  truths:
    - "generateDefaultTasks produces exactly 6 task objects"
    - "Task 1 deadline equals warmup_start_date (offset 0)"
    - "Each subsequent task is 1 day apart"
    - "Only the onboarding call task has is_date_editable: true"
    - "All tasks start as not completed and not urgent"
  artifacts:
    - path: "src/lib/default-tasks.ts"
      provides: "DEFAULT_TASKS array and generateDefaultTasks function"
      exports: ["DEFAULT_TASKS", "generateDefaultTasks"]
    - path: "src/lib/__tests__/default-tasks.test.ts"
      provides: "Unit tests for default task generation"
      min_lines: 40
  key_links:
    - from: "src/lib/default-tasks.ts"
      to: "date-fns"
      via: "addDays import"
      pattern: "addDays"
---

<objective>
Implement and test the default task generation logic using TDD.

Purpose: When a company is created, 6 default tasks must be auto-generated with correct titles, dates (1 day apart starting from warmup_start_date), and editability flags. This is pure business logic with defined inputs/outputs -- a perfect TDD candidate. Getting the day offsets and editability flags right is critical (DTSK-01 through DTSK-08).

Output: A tested `generateDefaultTasks` function and `DEFAULT_TASKS` constant array.
</objective>

<execution_context>
@C:\Users\bstei\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\bstei\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-company-management-default-tasks/02-RESEARCH.md

@src/types/database.ts
</context>

<feature>
  <name>Default Task Generation</name>
  <files>src/lib/default-tasks.ts, src/lib/__tests__/default-tasks.test.ts</files>
  <behavior>
    generateDefaultTasks(companyId: string, warmupStartDate: string) produces an array of 6 task objects.

    Given companyId = "abc-123" and warmupStartDate = "2026-03-01":

    Task 1: { company_id: "abc-123", title: "Create email templates", deadline: "2026-03-01", is_completed: false, is_urgent: false, is_date_editable: false, notes: null }
    Task 2: { company_id: "abc-123", title: "Have an onboarding call", deadline: "2026-03-02", is_completed: false, is_urgent: false, is_date_editable: true, notes: null }
    Task 3: { company_id: "abc-123", title: "Buy custom domains and mailboxes, place in warmup tool", deadline: "2026-03-03", is_completed: false, is_urgent: false, is_date_editable: false, notes: null }
    Task 4: { company_id: "abc-123", title: "Create an RLM", deadline: "2026-03-04", is_completed: false, is_urgent: false, is_date_editable: false, notes: null }
    Task 5: { company_id: "abc-123", title: "Create follow-up mails", deadline: "2026-03-05", is_completed: false, is_urgent: false, is_date_editable: false, notes: null }
    Task 6: { company_id: "abc-123", title: "Create a dashboard", deadline: "2026-03-06", is_completed: false, is_urgent: false, is_date_editable: false, notes: null }

    Edge cases to test:
    - Month boundary: warmupStartDate = "2026-01-30" -> tasks span into February
    - Year boundary: warmupStartDate = "2025-12-29" -> tasks span into 2026
    - All tasks have the same company_id
    - Exactly 6 tasks always returned
    - Only task index 1 (onboarding call) has is_date_editable: true

    DEFAULT_TASKS constant should export the 6 task definitions with title, dayOffset (0-5), and is_date_editable fields.
  </behavior>
  <implementation>
    Use date-fns `addDays` and `format` for date arithmetic. Keep dates as YYYY-MM-DD strings.
    Parse warmupStartDate with `new Date(warmupStartDate + 'T00:00:00')` to avoid timezone offset issues.
    Use zero-based offsets: day 1 = offset 0, day 2 = offset 1, ..., day 6 = offset 5.
    Return type: `Omit<Task, 'id' | 'created_at'>[]` matching the Supabase Insert type for tasks.
    See RESEARCH.md Pattern 3 for reference implementation.
  </implementation>
</feature>

<verification>
- `npm test -- default-tasks` passes all tests
- Tests cover: exact task count, correct titles, correct dates, month/year boundary, editability flags
</verification>

<success_criteria>
- generateDefaultTasks returns exactly 6 tasks with correct titles in correct order
- Deadlines start at warmup_start_date and increment by 1 day each
- Only "Have an onboarding call" (index 1) has is_date_editable: true
- All other tasks have is_date_editable: false
- All tasks have is_completed: false, is_urgent: false, notes: null
- Tests pass for normal dates and month/year boundaries
</success_criteria>

<output>
After completion, create `.planning/phases/02-company-management-default-tasks/02-01-SUMMARY.md`
</output>
